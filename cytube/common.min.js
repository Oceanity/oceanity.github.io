"use strict";$(()=>{function e(){r(`Searching Tenor for: ${l}, safe search ${c?"off":"on"}`),v.empty(),p.show(function(){$.ajax({url:`https://api.tenor.com/v1/search?q=${l}&locale=en_US&media_filter=minimal&contentfilter=${c?"off":"high"}`,success:function(e){const{results:t}=e;for(let e of t){const{media:t,url:n}=e;let o=t.shift(),i=$("<li>",{"data-full":o.gif.url}),a=$("<img>",{src:o.tinygif.url});i.click(function(e){s.val($(this).data("full")).trigger(f),p.hide(function(){v.empty()})}),i.append(a),v.append(i)}}})})}function t(){if(s.val().length&&0==s.val().indexOf(a)){let t=s.val().split(" "),n=t.shift().substr(1).toLowerCase(),o=t.join(" ").trim();switch(n){case"tenor":return l=o,void e()}}p.fadeOut(function(){v.empty()})}function n(e){$(e).find("a").each(function(e,t){const n=$(t);let i=t.href;-1!=i.match(/.+wikia.+\.\w{3,4}\/revision\/.+/gi)&&(i=i.split("/revision/")[0],n.attr("href",i)),o(i,e=>{if(e){const e=$("<img>",{onload:function(){d.scrollTop(d[0].scrollHeight)},src:i}),o=$("<div>",{class:"embedded-image"}),s=$("<div>",{class:"embedded-image-wrapper"});n.addClass("image-link").text(""),o.insertAfter($(t)),o.append(s),s.append(e),s.append(n),d.scrollTop(d[0].scrollHeight)}else{const e=/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/gi,t=e.exec(i);if(t){const e=$("<div>",{class:"embedded-frame"}).appendTo(n.parent()),o=$("<div>",{class:"embedded-frame-wrapper"}).appendTo(e);$("<iframe>",{src:`https://www.youtube.com/embed/${t[1]}`,frameborder:0}).appendTo(o);n.addClass("embed-link"),d.scrollTop(d[0].scrollHeight)}const o=/(?:https?\/\/)?(?:www\.)?twitter\.com\/(?:.+)\/status\/(?:\d+)/gi,s=o.exec(i);s&&(r("%c[Twitter link found, embedding]","color:#1DA1F2"),$.ajax({url:`https://publish.twitter.com/oembed?url=${i}&theme=dark&widget=Tweet`,dataType:"jsonp",success:function(e){r(e),n.parent().html(e.html)}}))}})})}function o(e,t,n=5e3){var o,i=!1,s=new Image;s.onerror=s.onabort=function(){i||(clearTimeout(o),t(!1))},s.onload=function(){i||(clearTimeout(o),t(!0))},s.src=e,o=setTimeout(function(){i=!0,t(null)},n)}const i=500,s=$("#chatline"),a="/";let c=!1,l="";const{log:r}=console,d=$("#messagebuffer"),u=$("#chatwrap"),f=$.Event("keydown",{keyCode:13}),p=$("<div>",{id:"tenorgifmodal"}),m=$("<div>",{id:"tenorgifswitches"}),h=$("<div>",{class:"checkboxGroup"}),g=$("<input>",{type:"checkbox",id:"shownsfw"}),w=$("<label>",{for:"shownsfw",text:"Show NSFW"}),v=$("<ul>");let b;g.change(function(t){c=t.target.checked,e()}),h.append(g).append(w),m.append(h),p.append(m,v),u.append(p),v.bind("mousewheel",function(e){e.preventDefault(),this.scrollLeft-=e.originalEvent.wheelDelta}),v.bind("DOMMouseScroll",function(e){e.preventDefault(),this.scrollLeft+=40*e.originalEvent.detail}),r("Initialized Oceanity Custom JS"),$("div[class^='chat-msg-']").each(function(e,t){n(t)}),socket.on("*",e=>{r("clear")}),socket.on("chatMsg",e=>{const{username:t,msg:o,meta:i,time:s}=e,a=document.getElementsByClassName(`chat-msg-${t}`);n(a[a.length-1])}),s.on("keyup",function(e){clearTimeout(b),b=setTimeout(t,i)})});